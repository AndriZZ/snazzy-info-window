/* Snazzy Infowindow */

@import "_settings";
@import "math/_math";

//////////////////////////////////////////////////
//
// Contents:
//
// 1. 
//
//////////////////////////////////////////////////



//////////////////////////////
// 0. Helpers
//////////////////////////////
//Make sure that no division by zero occurs

$angle: atan($si-shadow-v/if($si-shadow-h == 0, 0.00000001px, $si-shadow-h));
$rotated-angle: unitless-rad(rad-to-deg($angle) + 45); 

$left: $si-shadow-h / cos($angle);
$right: $si-shadow-v / sin($angle);
$max-shadow-distance: 0;
@if (abs($left) > abs($right)){
    $max-shadow-distance: $left;
}
@else{
    $max-shadow-distance: $right;
}

$rotated-shadow-h: ($max-shadow-distance * cos($rotated-angle));
$rotated-shadow-v: ($max-shadow-distance * sin($rotated-angle));

$shadow-offset: floor($si-shadow-v + ($si-shadow-spread * 1.414));



//////////////////////////////
// 1. Wrapper Styles
//////////////////////////////

// Infowindow wrapper
.snazzy-info-wrapper{    
    display: flex;
    align-items: center;
}

// Top-positioned infowindow
.snazzy-info-wrapper-top {
    transform: translate(-50%, -100%);
    margin-top: -$si-marker-height;
    flex-direction: column;

    .snazzy-info-pointer {
        order: 2;
        transform-origin: 0 100%;
        //margin-bottom: max($shadow-offset, 0);
    }
}

// Bottom-positioned infowindow
.snazzy-info-wrapper-bottom {
    transform: translate(-50%, 0);
    flex-direction: column;

    .snazzy-info-pointer {
        transform-origin: 100% 100%;
    }
}

// Left-positioned infowindow
.snazzy-info-wrapper-left {
    transform: translate(-100%, -50%);
    margin-top: $si-marker-height / -2;
    margin-left: $si-marker-width / -2;

    .snazzy-info-pointer {
        order: 2;
        transform: translate(0, 50%) rotate(-45deg) scale(1.414);
        transform-origin: 0 100%;
    }
}

// Right-positioned infowindow
.snazzy-info-wrapper-right {
    transform: translate(0, -50%);
    margin-top: $si-marker-height / -2;
    margin-left: $si-marker-width / 2;
}



//////////////////////////////
// 2. Content Styles
//////////////////////////////

// Content wrapper
.snazzy-info-content {
    position: relative;
    width: 100%;
    z-index: 3;
    padding: $si-content-padding;
    background-color: $si-content-bg;
    border-radius: $si-border-radius;
    color: $si-content-color;
    font-size: $si-content-size;
}



//////////////////////////////
// 3. Pointer Styles
//////////////////////////////

// General pointer styles
[class*="snazzy-info-pointer-"] {
    align-self: stretch;
    position: relative;
    z-index: 2;
    //overflow: hidden;
}

.snazzy-info-pointer {
    flex: 0 0 auto;
    transform: translate(50%, 0) rotate(-45deg) scale(1.414);
    position: relative;
    width: $si-pointer-length;
    height: $si-pointer-length;
    margin: auto;
    z-index: 2;
    background-color: $si-pointer-bg;
}


//////////////////////////////
// 3. Infowindow Shadow
//////////////////////////////

[class*="snazzy-info-shadow-wrapper"] {
    display: flex;
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    z-index: 1;
    opacity: 0.4;
}

.snazzy-info-shadow-content {
    flex: 1 1 auto;
    display: block;
    box-shadow: $si-shadow-h $si-shadow-v $si-shadow-blur $si-shadow-spread $si-shadow-color;
}

.snazzy-info-shadow-pointer {
    box-shadow: ($rotated-shadow-h * .707) ($rotated-shadow-v * .707) ($si-shadow-blur * .707) ($si-shadow-spread * .707) $si-shadow-color;
    background-color: transparent;
}

.snazzy-info-shadow-wrapper-top,
.snazzy-info-shadow-wrapper-bottom {
    flex-direction: column;
}